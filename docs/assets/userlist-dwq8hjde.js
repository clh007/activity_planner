/* empty css             *//* empty css                   *//* empty css                      *//* empty css                 *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                        */import"./el-tooltip-l0sNRNKZ.js";/* empty css                  */import{d as O,r as p,C as G,as as F,i as Q,g as e,a as o,f as b,S as H,a5 as K,at as W,Q as X,o as Y,k as u,a6 as $,y as ee,z as ae,a7 as oe,l as le,au as te,R as re,P as se,av as ne,aa as de,_ as ue}from"./index-D8buL-En.js";import{i as h}from"./request-A0HPcR3J.js";/* empty css                       */import"./user-CM_eeQ3J.js";import"./el-message-BVXy5W2-.js";const ie=n=>h.post("/user/add",JSON.stringify(n),{headers:{"Content-Type":"application/json"}}),pe=(n,c)=>h.post("/user/list",{page:n,size:c},{headers:{"Content-Type":"application/json"}}),me=n=>h.post("/user/setpassword",JSON.stringify(n),{headers:{"Content-Type":"application/json"}}),ge=n=>h.post("/user/delete/"+n),ce=n=>(ee("data-v-419f1a84"),n=n(),ae(),n),fe={class:"user_management"},_e=ce(()=>b("h1",{class:"page-title"},"用户管理",-1)),ve={class:"handler flex-center"},we={class:"pagination-container"},be={class:"dialog-footer"},Ve={class:"dialog-footer"},ye=O({__name:"userlist",setup(n){const c=p(!1),r=p({username:"",password:"",userpwdagain:"",phone:"",email:"",gender:0,is_admin:1});G(async()=>{await _()});const V=p([]),f=p(),A=p(0),C=p(10),U=p(1),_=async()=>{try{const t=await pe(U.value,C.value);V.value=t.data.data.content,A.value=t.data.data.totalElements}catch(t){console.error(t)}},I=t=>{U.value=t,_()},q=t=>{C.value=t,_()},S=F({username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:20,message:"用户名长度应在 3 到 20 个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{pattern:/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,16}$/,message:"密码应为8-16位,包含大小写字母、数字和特殊符号",trigger:"blur"}],userpwdagain:[{required:!0,message:"请确认密码",trigger:"blur"},{validator:(t,a,s)=>{a!==r.value.password?s(new Error("两次输入的密码不一致")):s()},trigger:"blur"}],phone:[{required:!0,message:"请输入手机号码",trigger:"blur"},{pattern:/^1[3456789]\d{9}$/,message:"手机号码格式不正确",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱地址",trigger:"blur"},{pattern:/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,message:"请输入正确的邮箱地址",trigger:["blur","change"]}],gender:[{required:!0,message:"请选择性别",trigger:"change"}],is_admin:[{required:!0,message:"请选择是否是管理员",trigger:"change"}]}),Z={new_password:[{required:!0,message:"请输入新密码",trigger:"blur"},{min:6,message:"密码长度不能少于6位",trigger:"blur"}],confirmPassword:[{required:!0,message:"请再次输入新密码",trigger:"blur"},{min:6,message:"密码长度不能少于6位",trigger:"blur"},{validator:(t,a,s)=>{a!==m.new_password?s(new Error("两次输入的密码不一致")):s()},trigger:"blur"}]},P=()=>{f.value&&f.value.resetFields()},R=()=>{w.value&&w.value.resetFields()},T=()=>{c.value=!0},B=async()=>{if(f.value)try{if(await f.value.validate()){console.log(r.value);const a=await ie(r.value);c.value=!1,_(),P(),console.log(a)}}catch(t){console.error(t)}},v=p(!1),w=p(),m=F({userid:0,new_password:"",confirmPassword:""}),N=(t,a)=>{v.value=!0,m.userid=a[t].id},j=async()=>{if(w.value)try{if(await w.value.validate()){const a=await me(m);v.value=!1,R(),console.log(a)}}catch(t){console.error(t)}},D=async(t,a)=>{const s=a[t];try{await de.confirm(`您确定要删除用户 "${s.name}" 吗？`,"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"})&&(await ge(s.id),a.splice(t,1),_())}catch(d){d!=="cancel"&&console.error(d)}};return(t,a)=>{const s=H,d=oe,M=K,J=W,g=le,i=te,y=re,z=se,E=ne,x=X;return Y(),Q("div",fe,[_e,e(s,{type:"primary",onClick:T,style:{margin:"15px 0"}},{default:o(()=>[u("+新增")]),_:1}),e(M,{data:V.value,border:"",style:{width:"100%"},"max-height":"750"},{default:o(()=>[e(d,{prop:"username",label:"用户名"}),e(d,{prop:"gender",label:"性别"}),e(d,{prop:"phone",label:"手机"}),e(d,{prop:"email",label:"邮箱"}),e(d,{prop:"activityCount",label:"活动数量"}),e(d,{prop:"create_time",label:"创建时间","show-overflow-tooltip":""}),e(d,{prop:"update_time",label:"修改时间","show-overflow-tooltip":""}),e(d,{label:"操作","header-align":"center"},{default:o(({row:l,$index:k})=>[b("div",ve,[e(s,{type:"warning",onClick:$(L=>N(k,V.value),["prevent","stop"])},{default:o(()=>[u(" 修改 ")]),_:2},1032,["onClick"]),e(s,{onClick:$(L=>D(k,V.value),["prevent"]),type:"danger"},{default:o(()=>[u(" 删除 ")]),_:2},1032,["onClick"])])]),_:1})]),_:1},8,["data"]),b("div",we,[e(J,{onSizeChange:q,onCurrentChange:I,"current-page":U.value,"page-sizes":[10,20,50,100],"page-size":C.value,total:A.value,layout:"total, sizes, prev, pager, next, jumper"},null,8,["current-page","page-size","total"])]),e(x,{modelValue:c.value,"onUpdate:modelValue":a[9]||(a[9]=l=>c.value=l),title:"添加用户",width:"30%"},{footer:o(()=>[b("span",be,[e(s,{type:"primary",onClick:a[7]||(a[7]=l=>B())},{default:o(()=>[u("确定")]),_:1}),e(s,{onClick:a[8]||(a[8]=l=>P())},{default:o(()=>[u("重置")]),_:1})])]),default:o(()=>[e(E,{ref_key:"userAddFormRef",ref:f,model:r.value,rules:S,"label-width":"80px"},{default:o(()=>[e(i,{label:"用户名",prop:"username"},{default:o(()=>[e(g,{modelValue:r.value.username,"onUpdate:modelValue":a[0]||(a[0]=l=>r.value.username=l),autocomplete:"off",placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),e(i,{label:"密码",prop:"password"},{default:o(()=>[e(g,{type:"password",modelValue:r.value.password,"onUpdate:modelValue":a[1]||(a[1]=l=>r.value.password=l),autocomplete:"off",placeholder:"请输入密码"},null,8,["modelValue"])]),_:1}),e(i,{label:"确认密码",prop:"userpwdagain"},{default:o(()=>[e(g,{type:"password",modelValue:r.value.userpwdagain,"onUpdate:modelValue":a[2]||(a[2]=l=>r.value.userpwdagain=l),autocomplete:"off",placeholder:"请确认密码"},null,8,["modelValue"])]),_:1}),e(i,{label:"手机",prop:"phone"},{default:o(()=>[e(g,{modelValue:r.value.phone,"onUpdate:modelValue":a[3]||(a[3]=l=>r.value.phone=l),autocomplete:"off",placeholder:"请输入手机"},null,8,["modelValue"])]),_:1}),e(i,{label:"邮箱",prop:"email"},{default:o(()=>[e(g,{modelValue:r.value.email,"onUpdate:modelValue":a[4]||(a[4]=l=>r.value.email=l),autocomplete:"off",placeholder:"请输入邮箱"},null,8,["modelValue"])]),_:1}),e(i,{label:"性别",prop:"gender"},{default:o(()=>[e(z,{modelValue:r.value.gender,"onUpdate:modelValue":a[5]||(a[5]=l=>r.value.gender=l),class:"ml-4"},{default:o(()=>[e(y,{label:"0",value:0},{default:o(()=>[u("男")]),_:1}),e(y,{label:"1",value:1},{default:o(()=>[u("女")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(i,{label:"管理员",prop:"is_admin"},{default:o(()=>[e(z,{modelValue:r.value.is_admin,"onUpdate:modelValue":a[6]||(a[6]=l=>r.value.is_admin=l),class:"ml-4"},{default:o(()=>[e(y,{label:"0",value:1},{default:o(()=>[u("是")]),_:1}),e(y,{label:"1",value:0},{default:o(()=>[u("否")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"]),e(x,{modelValue:v.value,"onUpdate:modelValue":a[13]||(a[13]=l=>v.value=l),title:"修改密码",width:"30%"},{footer:o(()=>[b("span",Ve,[e(s,{onClick:a[12]||(a[12]=l=>v.value=!1)},{default:o(()=>[u("取消")]),_:1}),e(s,{type:"primary",onClick:j},{default:o(()=>[u("确定")]),_:1})])]),default:o(()=>[e(E,{ref_key:"passwordFormRef",ref:w,model:m,rules:Z,"label-width":"100px"},{default:o(()=>[e(i,{label:"新密码",prop:"newPassword"},{default:o(()=>[e(g,{type:"password",modelValue:m.new_password,"onUpdate:modelValue":a[10]||(a[10]=l=>m.new_password=l),autocomplete:"off",placeholder:"请输入新密码"},null,8,["modelValue"])]),_:1}),e(i,{label:"确认密码",prop:"confirmPassword"},{default:o(()=>[e(g,{type:"password",modelValue:m.confirmPassword,"onUpdate:modelValue":a[11]||(a[11]=l=>m.confirmPassword=l),autocomplete:"off",placeholder:"请再次输入新密码"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}}),Ne=ue(ye,[["__scopeId","data-v-419f1a84"]]);export{Ne as default};
