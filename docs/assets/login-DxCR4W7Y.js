/* empty css             *//* empty css                   *//* empty css                  *//* empty css                 */import{d as W,r as p,i as b,f as t,n as v,b as u,O as d,g as h,a as m,u as z,E as o,P as F,Q as O,o as k,k as U,y as j,z as J,R as M,S as G,_ as Q}from"./index-BHlgj7l2.js";import{i as V}from"./request-iNMFsRdq.js";import{q as H}from"./index-C5yVZb0f.js";import{u as K}from"./el-message-CmegJjj8.js";import{p as C,e as I}from"./common-JspXp6_I.js";import{u as L}from"./user-B7xrpIBA.js";const X=n=>V.post("/auth/login",H.stringify(n)),Y=n=>V.post("/auth/register",JSON.stringify(n),{headers:{"Content-Type":"Application/json"}}),S=(n,_)=>{const r=`/auth/verification/code?${`identifier=${n}&type=${_}`}`;return V.get(r,{headers:{"Content-Type":"application/json"}})},Z=(n,_,y)=>V.get(`/auth/find/password?account=${n}&&password=${_}&&code=${y}`),f=n=>(j("data-v-76507042"),n=n(),J(),n),ee={class:"body"},te={class:"main"},oe={class:"form"},ae=f(()=>t("h2",{class:"form_title title"},"注册",-1)),le={class:"code"},se={class:"form"},re=f(()=>t("h2",{class:"form_title title"},"登录",-1)),ne=f(()=>t("h2",{class:"switch__title title"},"没有帐号？",-1)),ie=f(()=>t("p",{class:"switch__description description"},"立即注册吧😃",-1)),ue=f(()=>t("h2",{class:"switch__title title"},"已有帐号？",-1)),de=f(()=>t("p",{class:"switch__description description"},"请登录🚀",-1)),ce=W({__name:"login",setup(n){const _=z(),y=K(),r=p(!0),g=p("0"),l=p(""),i=p(""),w=p(""),c=p(""),P=()=>{if(l.value===""){o.error({message:"请输入手机号或邮箱"});return}if(!(C(l.value)||I(l.value))){o.error({message:"请输入正确的手机号或者邮箱"});return}if(i.value===""){o.error({message:"请输入密码"});return}let s={account:l.value,password:i.value};X(s).then(e=>{e.data.code===400&&o.error(e.data.message),e.data.code===200&&(o.success({message:"登录成功"}),L().setUser(e.data.data),y.login(),localStorage.setItem("userToken",e.data.data.userToken),localStorage.setItem("currentUser",JSON.stringify(e.data.data)),_.push({name:"home"}))}).catch(e=>{})},E=async()=>{if(w.value===""){o.error("请输入用户名!");return}if(l.value===""){o.error("请输入手机号或者邮箱!");return}if(i.value===""){o.error("请输入密码!");return}if(c.value===""){o.error("请输入验证码!");return}let s={username:w.value,password:i.value,code:c.value};g.value==="0"?s.phone=l.value:s.email=l.value,await Y(s).then(e=>{e.data.code===200?o.success("注册成功"):e.data.code===400&&o.error(e.data.message)}).catch(e=>{o.error("注册失败")})},N=()=>{if(l.value===""){o.error("请输入手机号或者邮箱!");return}if(g.value==="0")if(C(l.value))S(l.value,"phone").then(s=>{s.data.code===200?o.success("获取成功!"):o.error(s.data.message),console.log(s.data)}).catch(s=>{console.log(s)});else{o.error("请输入有效手机号!");return}else if(I(l.value))S(l.value,"email").then(s=>{s.data.code===200?o.success("获取成功!"):o.error(s.data.message),console.log(s.data)}).catch(s=>{}),o.success("获取成功!");else{o.error("请输入有效邮箱!");return}},x=p(!1),T=()=>{x.value=!0},A=()=>{if(l.value===""){o.error("请输入手机号或者邮箱!");return}if(i.value===""){o.error("请输入密码!");return}if(c.value===""){o.error("请输入验证码!");return}Z(l.value,i.value,c.value).then(s=>{s.data.code===200?(o.success("密码重置成功"),c.value="",x.value=!1):o.error(s.data.message)}).catch(s=>{})},q=()=>{if(l.value===""){o.error("请输入手机或者邮箱!");return}if(I(l.value))S(l.value,"email").then(s=>{s.data.code===200?o.success("发送成功!"):o.error(s.data.message)}).catch(s=>{});else if(C(l.value)){o.error("暂不支持手机找回");return}else{o.error("请输入有效手机或者邮箱账号");return}};return(s,e)=>{const $=M,B=F,D=G,R=O;return k(),b("div",ee,[t("div",te,[t("div",{class:v(["container a-container",{"is-txl":r.value}])},[t("div",oe,[ae,u(t("input",{class:"form__input",type:"text",placeholder:"用户名","onUpdate:modelValue":e[0]||(e[0]=a=>w.value=a)},null,512),[[d,w.value]]),u(t("input",{class:"form__input",type:"password",placeholder:"密码","onUpdate:modelValue":e[1]||(e[1]=a=>i.value=a)},null,512),[[d,i.value]]),h(B,{modelValue:g.value,"onUpdate:modelValue":e[2]||(e[2]=a=>g.value=a),style:{width:"350px"}},{default:m(()=>[h($,{value:"0"},{default:m(()=>[U("手机号")]),_:1}),h($,{value:"1",style:{"margin-left":"50px"}},{default:m(()=>[U("邮箱")]),_:1})]),_:1},8,["modelValue"]),g.value==="1"?u((k(),b("input",{key:0,class:"form__input",type:"email",placeholder:"邮箱","onUpdate:modelValue":e[3]||(e[3]=a=>l.value=a)},null,512)),[[d,l.value]]):u((k(),b("input",{key:1,class:"form__input",type:"tel",placeholder:"手机号","onUpdate:modelValue":e[4]||(e[4]=a=>l.value=a)},null,512)),[[d,l.value]]),t("div",le,[u(t("input",{class:"form__input",style:{width:"200px"},type:"text",placeholder:"验证码","onUpdate:modelValue":e[5]||(e[5]=a=>c.value=a)},null,512),[[d,c.value]]),t("span",{onClick:N},"获取验证码")]),t("button",{class:"form__button button",onClick:E},"注册")])],2),t("div",{class:v(["container b-container",[{"is-txl":r.value},{"is-z200":r.value}]])},[t("div",se,[re,u(t("input",{class:"form__input",type:"text",placeholder:"邮箱/手机号","onUpdate:modelValue":e[6]||(e[6]=a=>l.value=a)},null,512),[[d,l.value]]),u(t("input",{class:"form__input",type:"password",placeholder:"密码","onUpdate:modelValue":e[7]||(e[7]=a=>i.value=a)},null,512),[[d,i.value]]),t("a",{class:"form__link",onClick:e[8]||(e[8]=a=>T())},"忘记密码？"),t("button",{class:"form__button button",onClick:P},"登录")])],2),t("div",{class:v(["switch",{"is-txr":r.value}])},[t("div",{class:v(["switch__circle",{"is-txr":r.value}])},null,2),t("div",{class:v(["switch__circle switch__circle--t",{"is-txr":r.value}])},null,2),t("div",{class:v(["switch__container",{"is-hidden":!r.value}])},[ne,ie,t("button",{class:"switch__button button",onClick:e[9]||(e[9]=a=>r.value=!r.value)},"注册")],2),t("div",{class:v(["switch__container",{"is-hidden":r.value}])},[ue,de,t("button",{class:"switch__button button",onClick:e[10]||(e[10]=a=>r.value=!r.value)},"登录")],2)],2)]),h(R,{title:"密码找回",modelValue:x.value,"onUpdate:modelValue":e[16]||(e[16]=a=>x.value=a),width:"25%",center:""},{footer:m(()=>[h(D,{type:"info",onClick:e[15]||(e[15]=a=>A())},{default:m(()=>[U("提交")]),_:1})]),default:m(()=>[u(t("input",{class:"form__input",type:"text",placeholder:"邮箱/手机号","onUpdate:modelValue":e[11]||(e[11]=a=>l.value=a)},null,512),[[d,l.value]]),u(t("input",{class:"form__input",type:"text",placeholder:"新密码","onUpdate:modelValue":e[12]||(e[12]=a=>i.value=a)},null,512),[[d,i.value]]),u(t("input",{class:"form__input",style:{width:"200px"},type:"text",placeholder:"验证码","onUpdate:modelValue":e[13]||(e[13]=a=>c.value=a)},null,512),[[d,c.value]]),t("span",{onClick:e[14]||(e[14]=a=>q()),style:{cursor:"pointer","padding-left":"10px"}},"获取验证码")]),_:1},8,["modelValue"])])}}}),Ve=Q(ce,[["__scopeId","data-v-76507042"]]);export{Ve as default};
