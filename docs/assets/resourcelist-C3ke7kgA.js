/* empty css             *//* empty css                   *//* empty css                      *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                        */import"./el-tooltip-l0sNRNKZ.js";/* empty css                  */import{d as K,r,C as j,as as G,i as R,f as g,g as e,a as n,U as O,l as Q,S as W,a5 as H,at as J,Q as X,o as v,k as f,a6 as Y,F as A,G as Z,c as I,y as ee,z as ae,W as le,a7 as oe,au as te,av as ne,aa as re,_ as ue}from"./index-DMHF-AeG.js";import{b as se,c as de,d as me,e as ce}from"./resource-C--OgP2q.js";/* empty css                       */import"./request-Qmyq5DiB.js";import"./user-pKDXPlVp.js";import"./el-message-CY6Vz1He.js";const ie=b=>(ee("data-v-ca56b432"),b=b(),ae(),b),pe={class:"resource-manage"},_e=ie(()=>g("h1",{class:"page-title"},"资源管理",-1)),ve={class:"resource_search"},fe={class:"handler flex-center"},ge={class:"pagination-container"},be={class:"dialog-footer"},ye=K({__name:"resourcelist",setup(b){const y=r(!1),t=r({name:"",newname:"",total_num:0,current_num:0}),m=r(),E=r(0),V=r(10),h=r(1),w=r(""),C=r(""),u=r([{id:0,name:"",total_num:0,current_num:0}]);j(async()=>{await c()});const B=l=>{l===0?(t.value.total_num=0,t.value.current_num=0):(t.value.name=u.value[l].name,t.value.total_num=0,t.value.current_num=0)},F=l=>{h.value=l,c()},U=l=>{V.value=l,c()},z=G({total_num:[{required:!0,message:"请输入总数量",trigger:"blur"},{type:"number",message:"总数量必须为数字",trigger:"blur"}],current_num:[{required:!0,message:"请输入当前可用数量",trigger:"blur"},{type:"number",message:"当前可用数量必须为数字",trigger:"blur"}]}),x=()=>{m.value&&m.value.resetFields()},S=()=>{console.log("==============="),console.log(u.value),y.value=!0},c=async()=>{try{const l=await se(h.value,V.value);u.value=l.data.data.content,E.value=l.data.data.totalElements}catch(l){console.error(l)}},T=async()=>{if(m.value)try{if(await m.value.validate()){const a=await me(t.value);y.value=!1,c(),x(),console.log(a)}}catch(l){console.error(l)}},M=async(l,a)=>{const s=a[l];try{await re.confirm(`您确定要删除资源 "${s.name}" 吗？`,"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"})&&(await ce(s.id),a.splice(l,1),c())}catch(d){d!=="cancel"&&console.error(d)}},P=async()=>{if(w.value&&C.value)try{const l=await de(w.value,C.value,h.value,V.value);u.value=l.data.data.content,E.value=l.data.data.totalElements}catch(l){console.error(l)}};return(l,a)=>{const s=le,d=O,i=Q,p=W,k=oe,L=H,$=J,_=te,D=ne,N=X;return v(),R("div",pe,[_e,g("div",ve,[e(d,{modelValue:w.value,"onUpdate:modelValue":a[0]||(a[0]=o=>w.value=o),placeholder:"请选择搜索类型"},{default:n(()=>[e(s,{label:"资源名称",value:"name"})]),_:1},8,["modelValue"]),e(i,{modelValue:C.value,"onUpdate:modelValue":a[1]||(a[1]=o=>C.value=o),placeholder:"请输入搜索关键词"},null,8,["modelValue"]),e(p,{type:"primary",onClick:P},{default:n(()=>[f("搜索")]),_:1})]),e(p,{type:"primary",onClick:S,style:{margin:"15px 0"}},{default:n(()=>[f("+新增")]),_:1}),e(L,{data:u.value,border:"",style:{width:"100%"},"max-height":"750"},{default:n(()=>[e(k,{prop:"name",label:"资源名称"}),e(k,{prop:"total_num",label:"总数量"}),e(k,{prop:"current_num",label:"当前已用数量"}),e(k,{label:"操作","header-align":"center"},{default:n(({row:o,$index:q})=>[g("div",fe,[e(p,{onClick:Y(Ve=>M(q,u.value),["prevent"]),type:"danger"},{default:n(()=>[f(" 删除 ")]),_:2},1032,["onClick"])])]),_:1})]),_:1},8,["data"]),g("div",ge,[e($,{onSizeChange:U,onCurrentChange:F,"current-page":h.value,"page-sizes":[10,20,50,100],"page-size":V.value,total:E.value,layout:"total, sizes, prev, pager, next, jumper"},null,8,["current-page","page-size","total"])]),e(N,{modelValue:y.value,"onUpdate:modelValue":a[9]||(a[9]=o=>y.value=o),title:"添加资源",width:"30%"},{footer:n(()=>[g("span",be,[e(p,{type:"primary",onClick:a[7]||(a[7]=o=>T())},{default:n(()=>[f("确定")]),_:1}),e(p,{onClick:a[8]||(a[8]=o=>x())},{default:n(()=>[f("重置")]),_:1})])]),default:n(()=>[e(D,{ref_key:"resourceAddFormRef",ref:m,model:t.value,rules:z,"label-width":"80px"},{default:n(()=>[e(_,{label:"资源名称",prop:"name"},{default:n(()=>[e(d,{modelValue:t.value.name,"onUpdate:modelValue":a[2]||(a[2]=o=>t.value.name=o),onChange:B},{default:n(()=>[(v(!0),R(A,null,Z(u.value,o=>(v(),I(s,{key:o.id,label:o.name,value:o.name},null,8,["label","value"]))),128)),e(s,{label:"其他",value:"其他"})]),_:1},8,["modelValue"])]),_:1}),t.value.name==="其他"?(v(),R(A,{key:0},[e(_,{label:"添加的资源名称",prop:"newname"},{default:n(()=>[e(i,{modelValue:t.value.newname,"onUpdate:modelValue":a[3]||(a[3]=o=>t.value.newname=o),autocomplete:"off",placeholder:"请输入添加的资源名称"},null,8,["modelValue"])]),_:1}),e(_,{label:"总数量",prop:"total_num"},{default:n(()=>[e(i,{modelValue:t.value.total_num,"onUpdate:modelValue":a[4]||(a[4]=o=>t.value.total_num=o),modelModifiers:{number:!0},autocomplete:"off",placeholder:"请输入总数量"},null,8,["modelValue"])]),_:1}),e(_,{label:"当前已用数量",prop:"current_num"},{default:n(()=>[e(i,{modelValue:t.value.current_num,"onUpdate:modelValue":a[5]||(a[5]=o=>t.value.current_num=o),modelModifiers:{number:!0},autocomplete:"off",placeholder:"请输入当前已用数量"},null,8,["modelValue"])]),_:1})],64)):(v(),I(_,{key:1,label:"修改数量",prop:"total_num"},{default:n(()=>[e(i,{modelValue:t.value.total_num,"onUpdate:modelValue":a[6]||(a[6]=o=>t.value.total_num=o),modelModifiers:{number:!0},autocomplete:"off",placeholder:"请输入修改数量，添加输入正数，减少输入负数"},null,8,["modelValue"])]),_:1}))]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}}}),Le=ue(ye,[["__scopeId","data-v-ca56b432"]]);export{Le as default};
