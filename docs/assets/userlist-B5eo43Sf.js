/* empty css             *//* empty css                   *//* empty css                      *//* empty css                 *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                        */import"./el-tooltip-l0sNRNKZ.js";/* empty css                  */import{d as G,r as i,C as Q,as as I,i as H,g as e,a as o,f as V,S as K,a5 as W,at as X,Q as Y,o as Z,k as u,a6 as S,y as ee,z as ae,a7 as oe,l as le,au as te,R as se,P as re,av as ne,aa as de,_ as ue}from"./index-DWOuGMkE.js";import{i as C}from"./request-BVinqq6X.js";/* empty css                       */import"./user-CrbKy_3f.js";import"./el-message-CvCZY6Cp.js";const pe=n=>C.post("/user/add",JSON.stringify(n),{headers:{"Content-Type":"application/json"}}),ie=(n,f)=>C.post("/user/list",{page:n,size:f},{headers:{"Content-Type":"application/json"}}),me=n=>C.post("/user/setpassword",JSON.stringify(n),{headers:{"Content-Type":"application/json"}}),ce=n=>C.post("/user/delete/"+n),fe=n=>(ee("data-v-c3ac2e37"),n=n(),ae(),n),_e={class:"user_management"},ve=fe(()=>V("h1",{class:"page-title"},"用户管理",-1)),ge={class:"handler flex-center"},we={class:"pagination-container"},Ve={class:"dialog-footer"},be={class:"dialog-footer"},ye=G({__name:"userlist",setup(n){const f=i(!1),s=i({username:"",password:"",userpwdagain:"",phone:"",email:"",gender:0,is_admin:1});Q(async()=>{await v()});const b=i([]),_=i(),P=i(0),U=i(10),h=i(1),v=async()=>{try{const t=await ie(h.value,U.value);b.value=t.data.data.content,P.value=t.data.data.totalElements}catch(t){console.error(t)}},z=t=>{h.value=t,v()},R=t=>{U.value=t,v()},T=I({}),B={new_password:[{required:!0,message:"请输入新密码",trigger:"blur"},{min:6,message:"密码长度不能少于6位",trigger:"blur"}],confirmPassword:[{required:!0,message:"请再次输入新密码",trigger:"blur"},{min:6,message:"密码长度不能少于6位",trigger:"blur"},{validator:(t,a,r)=>{a!==m.new_password?r(new Error("两次输入的密码不一致")):r()},trigger:"blur"}]},E=()=>{_.value&&_.value.resetFields()},N=()=>{w.value&&w.value.resetFields()},$=()=>{f.value=!0},j=async()=>{if(_.value)try{if(await _.value.validate()){console.log(s.value);const a=await pe(s.value);f.value=!1,v(),E(),console.log(a)}}catch(t){console.error(t)}},g=i(!1),w=i(),m=I({userid:0,new_password:"",confirmPassword:""}),D=(t,a)=>{g.value=!0,m.userid=a[t].id},M=async()=>{if(w.value)try{if(await w.value.validate()){const a=await me(m);g.value=!1,N(),console.log(a)}}catch(t){console.error(t)}},q=async(t,a)=>{const r=a[t];try{await de.confirm(`您确定要删除用户 "${r.name}" 吗？`,"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"})&&(await ce(r.id),a.splice(t,1),v())}catch(d){d!=="cancel"&&console.error(d)}};return(t,a)=>{const r=K,d=oe,J=W,L=X,c=le,p=te,y=se,k=re,x=ne,F=Y;return Z(),H("div",_e,[ve,e(r,{type:"primary",onClick:$,style:{margin:"15px 0"}},{default:o(()=>[u("+新增")]),_:1}),e(J,{data:b.value,border:"",style:{width:"100%"},"max-height":"750"},{default:o(()=>[e(d,{prop:"username",label:"用户名"}),e(d,{prop:"gender",label:"性别"}),e(d,{prop:"phone",label:"手机"}),e(d,{prop:"email",label:"邮箱"}),e(d,{prop:"activityCount",label:"活动数量"}),e(d,{prop:"create_time",label:"创建时间","show-overflow-tooltip":""}),e(d,{prop:"update_time",label:"修改时间","show-overflow-tooltip":""}),e(d,{label:"操作","header-align":"center"},{default:o(({row:l,$index:A})=>[V("div",ge,[e(r,{type:"warning",onClick:S(O=>D(A,b.value),["prevent","stop"])},{default:o(()=>[u(" 修改 ")]),_:2},1032,["onClick"]),e(r,{onClick:S(O=>q(A,b.value),["prevent"]),type:"danger"},{default:o(()=>[u(" 删除 ")]),_:2},1032,["onClick"])])]),_:1})]),_:1},8,["data"]),V("div",we,[e(L,{onSizeChange:R,onCurrentChange:z,"current-page":h.value,"page-sizes":[10,20,50,100],"page-size":U.value,total:P.value,layout:"total, sizes, prev, pager, next, jumper"},null,8,["current-page","page-size","total"])]),e(F,{modelValue:f.value,"onUpdate:modelValue":a[9]||(a[9]=l=>f.value=l),title:"添加用户",width:"30%"},{footer:o(()=>[V("span",Ve,[e(r,{type:"primary",onClick:a[7]||(a[7]=l=>j())},{default:o(()=>[u("确定")]),_:1}),e(r,{onClick:a[8]||(a[8]=l=>E())},{default:o(()=>[u("重置")]),_:1})])]),default:o(()=>[e(x,{ref_key:"userAddFormRef",ref:_,model:s.value,rules:T,"label-width":"80px"},{default:o(()=>[e(p,{label:"用户名",prop:"username"},{default:o(()=>[e(c,{modelValue:s.value.username,"onUpdate:modelValue":a[0]||(a[0]=l=>s.value.username=l),autocomplete:"off",placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),e(p,{label:"密码",prop:"password"},{default:o(()=>[e(c,{type:"password",modelValue:s.value.password,"onUpdate:modelValue":a[1]||(a[1]=l=>s.value.password=l),autocomplete:"off",placeholder:"请输入密码"},null,8,["modelValue"])]),_:1}),e(p,{label:"确认密码",prop:"userpwdagain"},{default:o(()=>[e(c,{type:"password",modelValue:s.value.userpwdagain,"onUpdate:modelValue":a[2]||(a[2]=l=>s.value.userpwdagain=l),autocomplete:"off",placeholder:"请确认密码"},null,8,["modelValue"])]),_:1}),e(p,{label:"手机",prop:"phone"},{default:o(()=>[e(c,{modelValue:s.value.phone,"onUpdate:modelValue":a[3]||(a[3]=l=>s.value.phone=l),autocomplete:"off",placeholder:"请输入手机"},null,8,["modelValue"])]),_:1}),e(p,{label:"邮箱",prop:"email"},{default:o(()=>[e(c,{modelValue:s.value.email,"onUpdate:modelValue":a[4]||(a[4]=l=>s.value.email=l),autocomplete:"off",placeholder:"请输入邮箱"},null,8,["modelValue"])]),_:1}),e(p,{label:"性别",prop:"gender"},{default:o(()=>[e(k,{modelValue:s.value.gender,"onUpdate:modelValue":a[5]||(a[5]=l=>s.value.gender=l),class:"ml-4"},{default:o(()=>[e(y,{label:"0",value:0},{default:o(()=>[u("男")]),_:1}),e(y,{label:"1",value:1},{default:o(()=>[u("女")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(p,{label:"管理员",prop:"is_admin"},{default:o(()=>[e(k,{modelValue:s.value.is_admin,"onUpdate:modelValue":a[6]||(a[6]=l=>s.value.is_admin=l),class:"ml-4"},{default:o(()=>[e(y,{label:"0",value:1},{default:o(()=>[u("是")]),_:1}),e(y,{label:"1",value:0},{default:o(()=>[u("否")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"]),e(F,{modelValue:g.value,"onUpdate:modelValue":a[13]||(a[13]=l=>g.value=l),title:"修改密码",width:"30%"},{footer:o(()=>[V("span",be,[e(r,{onClick:a[12]||(a[12]=l=>g.value=!1)},{default:o(()=>[u("取消")]),_:1}),e(r,{type:"primary",onClick:M},{default:o(()=>[u("确定")]),_:1})])]),default:o(()=>[e(x,{ref_key:"passwordFormRef",ref:w,model:m,rules:B,"label-width":"100px"},{default:o(()=>[e(p,{label:"新密码",prop:"newPassword"},{default:o(()=>[e(c,{type:"password",modelValue:m.new_password,"onUpdate:modelValue":a[10]||(a[10]=l=>m.new_password=l),autocomplete:"off",placeholder:"请输入新密码"},null,8,["modelValue"])]),_:1}),e(p,{label:"确认密码",prop:"confirmPassword"},{default:o(()=>[e(c,{type:"password",modelValue:m.confirmPassword,"onUpdate:modelValue":a[11]||(a[11]=l=>m.confirmPassword=l),autocomplete:"off",placeholder:"请再次输入新密码"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}}),je=ue(ye,[["__scopeId","data-v-c3ac2e37"]]);export{je as default};
